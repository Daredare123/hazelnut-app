@{
    ViewData["Title"] = "Dashboard";
}

<div class="container mt-5">
    <div class="row mb-4">
        <div class="col-12 text-center">
            <h1 class="display-4">Dashboard</h1>
            <p class="lead">Welcome, @User.Identity?.Name! Manage your business below.</p>
        </div>
    </div>

    <!-- Inventory Section -->
    <div class="row mb-4 justify-content-center">
        <div class="col-md-6">
            @{
                double stock = ViewBag.CurrentStock;
                bool lowStock = stock <= 5;
                string cardClass = lowStock ? "bg-warning" : "bg-dark";
                string textClass = "text-white";
            }
            <div class="card @cardClass @textClass shadow-sm text-center">
                <div class="card-body">
                    <h3 class="card-title">Current Inventory</h3>
                    <p class="display-4 font-weight-bold">@stock.ToString("N0") kg</p>
                    @if (lowStock)
                    {
                        <div class="alert alert-danger mt-2 mb-0 fw-bold">
                            <i class="bi bi-exclamation-triangle-fill"></i> LOW STOCK WARNING (5kg or less)
                        </div>
                    }
                    else
                    {
                         <p class="card-text">Hazelnuts in stock</p>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Financial Overview Section -->
    <div class="row mb-5">
        <h2 class="h4 mb-3 text-secondary border-bottom pb-2">Financial Overview</h2>
        <div class="col-md-4">
            <div class="card bg-success text-white shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Revenue</h5>
                    <p class="card-text display-6">@ViewBag.TotalSales.ToString("C")</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card bg-danger text-white shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Expenses</h5>
                    <p class="card-text display-6">@ViewBag.TotalExpenses.ToString("C")</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            @{
                double profit = ViewBag.TotalProfit;
                string profitClass = profit >= 0 ? "text-success" : "text-danger";
            }
            <div class="card border-secondary shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title text-secondary">Net Profit</h5>
                    <p class="card-text display-6 @profitClass">@profit.ToString("C")</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Section -->
    <div class="row mb-5">
        <div class="col-md-4">
            <div class="card bg-success text-white shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Sales Amount</h5>
                    <p class="card-text display-6">@ViewBag.TotalSalesAmount.ToString("C")</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card bg-info text-white shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Kg Sold</h5>
                    <p class="card-text display-6">@ViewBag.TotalQuantityKg.ToString("N2") kg</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card bg-primary text-white shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title">Number of Sales</h5>
                    <p class="card-text display-6">@ViewBag.SalesCount</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Monthly Performance Section -->
    <div class="row mb-5">
        <h2 class="h4 mb-3 text-secondary border-bottom pb-2">Monthly Performance (@DateTime.Now.ToString("MMMM yyyy"))</h2>
        <div class="col-md-4">
            <div class="card bg-light border-success shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title text-success">This Month Revenue</h5>
                    <p class="card-text h3">@ViewBag.MonthlyAmount.ToString("C")</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card bg-light border-info shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title text-info">This Month Kg Sold</h5>
                    <p class="card-text h3">@ViewBag.MonthlyKg.ToString("N2") kg</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card bg-light border-primary shadow-sm mb-3">
                <div class="card-body">
                    <h5 class="card-title text-primary">This Month Number of Sales</h5>
                    <p class="card-text h3">@ViewBag.MonthlyCount</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row text-center">
        <!-- Manage Sales Card -->
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Manage Sales</h5>
                    <p class="card-text">View and add new sales records.</p>
                    <a asp-controller="Sales" asp-action="Index" class="btn btn-primary mt-auto">Go to Sales</a>
                </div>
            </div>
        </div>

        <!-- Manage Expenses Card -->
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Manage Expenses</h5>
                    <p class="card-text">Track and control your expenses.</p>
                    <a asp-controller="Expenses" asp-action="Index" class="btn btn-warning mt-auto text-white">Go to Expenses</a>
                </div>
            </div>
        </div>

        <!-- Clients Card -->
        <div class="col-md-4 mb-4">
             <div class="card h-100 shadow-sm">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">Clients</h5>
                    <p class="card-text">Manage your client database.</p>
                    <a href="#" class="btn btn-secondary mt-auto">Coming Soon</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Logout Button -->
    <div class="row mt-5">
        <div class="col-12 text-center">
            <a asp-controller="Account" asp-action="Logout" class="btn btn-danger btn-lg">Logout</a>
        </div>
    </div>
</div>